---
title: "Cohesión horizontal y migración: Descriptivos Migración"
author: "René Canales, Asistente de Investigación del OCS"
date: today
lang: es
fontsize: 12pt
format:
  html:
    toc: true
    toc-location: left
    toc-depth: 2
    toc-expand: 1
    toc-title: Contenidos
    number-sections: true
    number-depth: 3
    theme:
      - ../ocs.scss
    code-link: true
    title-block-banner: true 
---

```{=html}
<style>
.logo {
    position: absolute;
    top: 20px;
    right: 30px;
}
</style>
```

<img src="ocs-new.jpeg" class="logo" width="262" height="120"/>

::: {style="text-align: justify"}
```{r}
#| label: packages
#| echo: false

pacman::p_load(
  dplyr, haven, sjlabelled,  psych,  purrr,  tidyr,  sjPlot,  ggplot2, 
  parameters,  table1,  car,  beeswarm, scales, ggrepel, corrplot,
  ggtext, patchwork, psych, kableExtra)
```

```{r}
#| label: database ola 1
#| echo: false 

elsoc_1 <- readRDS("../input/data/proc_data/elsoc_2016_mig.RData")
```

```{r}
#| label: database ola 2
#| echo: false 

elsoc_2 <- readRDS("../input/data/proc_data/elsoc_2017_mig.RData")
```

```{r}
#| label: database ola 3 
#| echo: false 

elsoc_3 <- readRDS("../input/data/proc_data/elsoc_2018_mig.RData")
```

```{r}
#| label: database ola 4
#| echo: false 

elsoc_4 <- readRDS("../input/data/proc_data/elsoc_2019_mig.RData")
```

```{r}
#| label: database ola 5
#| echo: false 

elsoc_5 <- readRDS("../input/data/proc_data/elsoc_2021_mig.RData")
```

```{r}
#| label: database ola 6
#| echo: false 

elsoc_6 <- readRDS("../input/data/proc_data/elsoc_2022_mig.RData")
```


```{r}
#| label: data-full
#| echo: false

# Agregar la variable ola a cada base
elsoc_1 <- elsoc_1 %>% mutate(ola = 1)
elsoc_2 <- elsoc_2 %>% mutate(ola = 2)
elsoc_3 <- elsoc_3 %>% mutate(ola = 3)
elsoc_4 <- elsoc_4 %>% mutate(ola = 4)

# Unir todas las olas en una sola base
elsoc_long <- bind_rows(elsoc_1, elsoc_2, elsoc_3, elsoc_4)
```

```{r}
#| label: data-full-2
#| echo: false

# Agregar la variable ola a cada base
elsoc_4 <- elsoc_4 %>% mutate(ola = 4)
elsoc_5 <- elsoc_5 %>% mutate(ola = 5)
elsoc_6 <- elsoc_6 %>% mutate(ola = 6)

# Unir todas las olas en una sola base
elsoc_long_2 <- bind_rows(elsoc_4, elsoc_5, elsoc_6)
```

# Migración en Chile: Percepciones, desafíos y oportunidades

Hasta fines de 2024, Chile alberga aproximadamente 1,9 millones de personas extranjeras, con predominio de hombres (51,1%) y concentración etaria entre 30 y 39 años. Los principales grupos son venezolanos (38%), peruanos (13,6%) y haitianos (9,8%) (SERMIG, 2024). La migración se ha convertido en un tema central de la agenda pública, no solo como desafío administrativo, sino también como eje de conflicto social y percepción ciudadana (SERMIG, 2025).

Los datos muestran un empeoramiento de las actitudes hacia migrantes: un 55% percibe conflictos “muy fuertes” entre nacionales y extranjeros (El País, 2025; La Tercera, 2025), y un 70% declara alta distancia social (Activa Research, 2025). La percepción de carga económica también es elevada: 72% de los chilenos considera que los migrantes presionan los servicios públicos, frente a 18% que reconoce su aporte positivo (Panel Ciudadano, 2024).


```{r}
#| label: fig-long-1
#| fig-cap: Tendencia de variables sobre migración ELSOC (2016-2019)
#| echo: false

# Variables a graficar
vars <- c("frecuencia_migrantes", "contacto_migrantes", "simpatia_migrantes", "perdida_identidad", "desempleo_migrantes")

# Nombres más legibles para la leyenda y facets
nombres_legibles <- c(
  "frecuencia_migrantes" = "Frecuencia de Contacto con migrantes",
  "contacto_migrantes" = "Contacto Positivo con Migrantes",
  "simpatia_migrantes" = "Simpatía hacia migrantes",
  "perdida_identidad" = "Pérdida de identidad",
  "desempleo_migrantes" = "Desempleo percibido por migrantes"
)

# Pasar a formato largo y calcular promedio por ola y variable
long_promedio <- elsoc_long %>%
  select(ola, all_of(vars)) %>%
  pivot_longer(
    cols = all_of(vars), 
    names_to = "variable", 
    values_to = "valor"
  ) %>%
  group_by(ola, variable) %>%
  summarise(promedio = mean(valor, na.rm = TRUE), .groups = "drop")

# Graficar con nombres legibles en la leyenda
ggplot(long_promedio, aes(x = ola, y = promedio, color = variable, group = variable)) +
  geom_line(linewidth = 1.2) +
  geom_point(size = 2) +
  scale_color_manual(values = c(
    "frecuencia_migrantes" = "#1b9e77",
    "contacto_migrantes" = "#d95f02",
    "simpatia_migrantes" = "#7570b3",
    "perdida_identidad" = "#e7298a",
    "desempleo_migrantes" = "#66a61e"
  ),
  labels = nombres_legibles) +
  labs(title = "Tendencia de variables sobre migración (ELSOC 2016-2019)",
       x = "Ola", y = "Promedio", color = "Variable") +
  scale_y_continuous(limits = c(1, 5), breaks = 1:5) +
  theme_minimal()
```
La interacción ciudadana es selectiva: abierta en ámbitos laborales y escolares, pero resistente en espacios cercanos como vecindario o relaciones jerárquicas (Criteria, 2025). Niños, niñas y adolescentes migrantes presentan alta vulnerabilidad, especialmente quienes viven en situación irregular, enfrentando riesgos de exclusión educativa, violencia y precariedad (SERMIG, 2025; Políticas Migratorias, 2024).

```{r}
#| label: desc-mig2
#| fig-cap: Distribución simplificada de respuestas ELSOC (2016-2019)
#| echo: false

# Variables a graficar (solo 3)
vars <- c("frecuencia_migrantes", "contacto_migrantes", "simpatia_migrantes")

# Nombres más legibles
nombres_legibles <- c(
  "frecuencia_migrantes" = "Frec. contacto migrantes",
  "contacto_migrantes" = "Contacto positivo migrantes",
  "simpatia_migrantes" = "Simpatía hacia migrantes"
)

# Convertir a formato largo y recodificar respuestas
long_data <- elsoc_long %>%
  select(ola, all_of(vars)) %>%
  pivot_longer(cols = all_of(vars), names_to = "variable", values_to = "valor") %>%
  filter(!is.na(valor)) %>%
  mutate(respuesta = case_when(
    valor %in% c(1, 2) ~ "Bajo (1-2)",
    valor == 3 ~ "Medio (3)",
    valor %in% c(4, 5) ~ "Alto (4-5)"
  ),
  respuesta = factor(respuesta, levels = c("Bajo (1-2)", "Medio (3)", "Alto (4-5)")))

# Calcular proporciones
freq_data <- long_data %>%
  group_by(ola, variable, respuesta) %>%
  summarise(freq = n(), .groups = "drop") %>%
  group_by(ola, variable) %>%
  mutate(prop = freq / sum(freq))

# Gráfico de barras apiladas con orden correcto
ggplot(freq_data, aes(x = factor(ola), y = prop, fill = respuesta)) +
  geom_bar(stat = "identity", position = position_stack(reverse = TRUE)) +
  facet_wrap(~variable, ncol = 3, labeller = labeller(variable = nombres_legibles)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_manual(values = c("Bajo (1-2)" = "#d73027",   # Rojo abajo
                               "Medio (3)" = "#fee08b",   # Amarillo al medio
                               "Alto (4-5)" = "#1a9850"), # Verde arriba
                    name = "Respuesta",
                    breaks = c("Bajo (1-2)", "Medio (3)", "Alto (4-5)")) +
  labs(title = "Distribución simplificada de respuestas (ELSOC 2016-2019)",
       x = "Ola", y = "Porcentaje") +
  theme_minimal() +
  theme(strip.text = element_text(size = 12),
        legend.position = "bottom")
```



```{r}
#| label: desc-mig3
#| fig-cap: Distribución simplificada de respuestas (ELSOC 2016-2019
#| echo: false

# Variables a graficar (las 2 restantes)
vars <- c("perdida_identidad", "desempleo_migrantes")

# Nombres más legibles
nombres_legibles <- c(
  "perdida_identidad" = "Pérdida de identidad",
  "desempleo_migrantes" = "Desempleo percibido por migrantes"
)

# Convertir a formato largo y recodificar respuestas
long_data <- elsoc_long %>%
  select(ola, all_of(vars)) %>%
  pivot_longer(cols = all_of(vars), names_to = "variable", values_to = "valor") %>%
  filter(!is.na(valor)) %>%
  mutate(respuesta = case_when(
    valor %in% c(1, 2) ~ "Bajo (1-2)",
    valor == 3 ~ "Medio (3)",
    valor %in% c(4, 5) ~ "Alto (4-5)"
  ),
  respuesta = factor(respuesta, levels = c("Bajo (1-2)", "Medio (3)", "Alto (4-5)")))

# Calcular proporciones
freq_data <- long_data %>%
  group_by(ola, variable, respuesta) %>%
  summarise(freq = n(), .groups = "drop") %>%
  group_by(ola, variable) %>%
  mutate(prop = freq / sum(freq))

# Gráfico de barras apiladas
ggplot(freq_data, aes(x = factor(ola), y = prop, fill = respuesta)) +
  geom_bar(stat = "identity", position = position_stack(reverse = TRUE)) +
  facet_wrap(~variable, ncol = 2, labeller = labeller(variable = nombres_legibles)) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  scale_fill_manual(values = c("Bajo (1-2)" = "#d73027",   # Rojo abajo
                               "Medio (3)" = "#fee08b",   # Amarillo al medio
                               "Alto (4-5)" = "#1a9850"), # Verde arriba
                    name = "Respuesta",
                    breaks = c("Bajo (1-2)", "Medio (3)", "Alto (4-5)")) +
  labs(title = "Distribución simplificada de respuestas (ELSOC 2016-2019)",
       x = "Ola", y = "Porcentaje") +
  theme_minimal() +
  theme(strip.text = element_text(size = 12),
        legend.position = "bottom")

```

Persisten barreras laborales, educativas, de salud y vivienda, con discriminación estructural y limitaciones legales para la contratación de extranjeros (CENEM, 2023; UCSH, 2019; UC, 2024). Las políticas públicas muestran fragmentación institucional, carencia de coordinación y escasos recursos para abordar la integración efectiva (Espacio Público, 2023; SJM, 2022).

El rechazo a migrantes está mediado por percepción de pobreza, competencia por recursos y narrativas mediáticas negativas (USACH, 2025; Ipsos, 2025). Aunque existe apoyo a derechos básicos, persiste el rechazo a derechos políticos y un 92% respalda políticas migratorias más estrictas (Panel Ciudadano, 2024). La dispersión territorial de migrantes genera tensiones locales y contribuye a desigualdades estructurales, consolidando la 

```{r}
#| label: desc-mig4
#| fig-cap: Tendencia Variables Igualdad Migrantes
#| echo: false

# Variables a graficar
vars <- c("confianza_migrantes", "fomentar_migracion", "igualdad_migrantes")

# Nombres más legibles para la leyenda y facets
nombres_legibles <- c(
  "confianza_migrantes" = "Confianza en migrantes",
  "fomentar_migracion" = "Fomentar Migracion Calificada",
  "igualdad_migrantes" = "Acceso a Salud Migrantes")

# Pasar a formato largo y calcular promedio por ola y variable
long_promedio_2 <- elsoc_long_2 %>%
  select(ola, all_of(vars)) %>%
  pivot_longer(
    cols = all_of(vars), 
    names_to = "variable", 
    values_to = "valor"
  ) %>%
  group_by(ola, variable) %>%
  summarise(promedio = mean(valor, na.rm = TRUE), .groups = "drop")

# Graficar con nombres legibles en la leyenda
ggplot(long_promedio_2, aes(x = ola, y = promedio, color = variable, group = variable)) +
  geom_line(linewidth = 1.2) +
  geom_point(size = 2) +
  scale_color_manual(values = c(
    "confianza_migrantes" = "#1b9e77",
    "fomentar_migracion" = "#d95f02",
    "igualdad_migrantes" = "#7570b3"
  ),
  labels = nombres_legibles) +
  labs(title = "Tendencia de variables sobre migrantes (ELSOC 2016-2019)",
       x = "Ola", y = "Promedio", color = "Variable") +
  scale_y_continuous(limits = c(1, 5), breaks = 1:5) +
  theme_minimal()
```
:::
